# services:
#   cloud_webserver_v2:
#     container_name: cloud_webserver_v2
#     build:
#       context: .
#       args:
#         MONGODB_URI: ${MONGODB_URI}
#         AWS_REGION: ${AWS_REGION}
#         AWS_S3_RUN_BUCKET: ${AWS_S3_RUN_BUCKET}
#         AWS_ACCESS_KEY: ${AWS_ACCESS_KEY}
#         AWS_SECRET_KEY: ${AWS_SECRET_KEY}
#     ports:
#       - "8080:8080"
#     env_file:
#       - stack.env
#     restart: unless-stopped
services:
  cloud_webserver_v2:
    container_name: cloud_webserver_v2
    build:
      context: .
      args:
        AWS_REGION: ${AWS_REGION}
        AWS_S3_RUN_BUCKET: ${AWS_S3_RUN_BUCKET}
        AWS_ACCESS_KEY: ${AWS_ACCESS_KEY}
        AWS_SECRET_KEY: ${AWS_SECRET_KEY}
    ports:
      - "8080:8080"
    env_file:
      - stack.env
    environment:
      MONGODB_URI: ${MONGODB_URI}
    volumes:
      - ./logs:/app/logs
    depends_on:
      - mongo
    restart: unless-stopped

  mongo:
    image: mongo:latest
    container_name: mongo
    environment:
      MONGO_INITDB_ROOT_USERNAME: username
      MONGO_INITDB_ROOT_PASSWORD: password
    ports:
      - "27017:27017"
